<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher Portal | ORLI International Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: #f5f7fb;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background: #003366;
      color: white;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .header-text {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .header-text img {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      background: white;
    }
    header h1 {
      font-size: 1.5em;
      margin: 0;
    }
    header p {
      margin-top: 5px;
      font-size: 1em;
      color: #ddd;
    }

    main {
      flex: 1;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .form-card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    label {
      font-weight: 600;
      display: block;
      margin-bottom: 8px;
      margin-top: 15px;
    }

    select, textarea, input {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 1em;
    }

    textarea {
      height: 150px;
      resize: vertical;
    }

    button {
      background: #003366;
      color: white;
      border: none;
      padding: 12px 18px;
      font-size: 1em;
      font-weight: 600;
      border-radius: 6px;
      margin-top: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background: #0055aa;
    }

    .lesson-list {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .lesson-item {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
    }

    .lesson-item:last-child {
      border: none;
    }

    .lesson-actions button {
      background: #0066cc;
      margin-right: 5px;
    }

    .lesson-actions button.delete {
      background: crimson;
    }

    footer {
      background: #003366;
      color: white;
      text-align: center;
      padding: 15px;
      font-size: 0.9em;
    }

    @media (max-width: 600px) {
      header h1 { font-size: 1.2em; }
      .form-card, .lesson-list { padding: 15px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-text">
      <img src="https://orli-international-academy.vercel.app/logo.png" alt="ORLI Logo" onerror="this.src='https://via.placeholder.com/60x60?text=Logo';">
      <h1>ORLI International Academy</h1>
    </div>
    <p>Holiday Learning Portal - Teacher Page</p>
  </header>

  <main>
    <div class="form-card">
      <h2>Share Lesson</h2>
      <label for="classSelect">Select Class:</label>
      <select id="classSelect">
        <option value="">-- Select Class --</option>
        <option>Nursery 1</option><option>Nursery 2</option>
        <option>Year 1</option><option>Year 2</option>
        <option>Year 3</option><option>Year 4</option>
        <option>Year 5</option><option>Year 6</option>
      </select>

      <label for="lessonNote">Lesson Note:</label>
      <textarea id="lessonNote" placeholder="Paste or type lesson note here..."></textarea>

      <label for="meetLink">Google Meet Link:</label>
      <input type="text" id="meetLink" placeholder="Paste Meet link here...">

      <button onclick="saveLesson()">Post Lesson</button>
    </div>

    <div class="lesson-list">
      <h2>Posted Lessons</h2>
      <div id="lessonContainer">Loading...</div>
    </div>
  </main>

  <footer>Â© 2025 ORLI International Academy. All Rights Reserved.</footer>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB4DMYZJHWgbRUZV-uamOy7TpxLM1sGYPY",
      authDomain: "chats-afcff.firebaseapp.com",
      databaseURL: "https://chats-afcff-default-rtdb.firebaseio.com",
      projectId: "chats-afcff",
      storageBucket: "chats-afcff.appspot.com",
      messagingSenderId: "764250889947",
      appId: "1:764250889947:web:2c843497ce389edf5876fe"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function saveLesson() {
      const className = document.getElementById('classSelect').value;
      const lesson = document.getElementById('lessonNote').value.trim();
      const link = document.getElementById('meetLink').value.trim();

      if (!className || !lesson || !link) {
        alert("Please fill all fields before posting.");
        return;
      }

      const newLessonRef = db.ref('holiday_lessons/' + className).push();
      newLessonRef.set({
        lesson,
        link,
        timestamp: new Date().toISOString()
      });

      document.getElementById('lessonNote').value = '';
      document.getElementById('meetLink').value = '';
      alert('Lesson posted successfully!');
      loadLessons();
    }

    function loadLessons() {
      const container = document.getElementById('lessonContainer');
      container.innerHTML = '';

      const className = document.getElementById('classSelect').value;
      if (!className) {
        container.innerHTML = '<p>Select a class to view posted lessons.</p>';
        return;
      }

      db.ref('holiday_lessons/' + className).on('value', snapshot => {
        const data = snapshot.val();
        if (!data) {
          container.innerHTML = '<p>No lessons posted yet.</p>';
          return;
        }

        container.innerHTML = '';
        Object.entries(data).forEach(([key, val]) => {
          const div = document.createElement('div');
          div.className = 'lesson-item';
          div.innerHTML = `
            <p><strong>Lesson:</strong><br>${val.lesson.replace(/\n/g, '<br>')}</p>
            <p><strong>Meet Link:</strong> <a href="${val.link}" target="_blank">${val.link}</a></p>
            <div class="lesson-actions">
              <button onclick="editLesson('${className}','${key}','${encodeURIComponent(val.lesson)}','${val.link}')">Edit</button>
              <button class="delete" onclick="deleteLesson('${className}','${key}')">Delete</button>
            </div>
          `;
          container.appendChild(div);
        });
      });
    }

    function editLesson(className, key, lesson, link) {
      const newLesson = prompt("Edit lesson note:", decodeURIComponent(lesson));
      if (newLesson === null) return;
      const newLink = prompt("Edit Google Meet link:", link);
      if (newLink === null) return;
      db.ref('holiday_lessons/' + className + '/' + key).update({ lesson: newLesson, link: newLink });
      alert('Lesson updated!');
    }

    function deleteLesson(className, key) {
      if (confirm("Are you sure you want to delete this lesson?")) {
        db.ref('holiday_lessons/' + className + '/' + key).remove();
        alert('Lesson deleted.');
      }
    }

    document.getElementById('classSelect').addEventListener('change', loadLessons);
  </script>
</body>
</html>